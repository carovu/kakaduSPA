"use strict";angular.module("kakaduSpaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngDragDrop","cgBusy","ajoslin.promise-tracker","kakaduSpaAppServices"]).config(["$routeProvider","$httpProvider",function(a,b){b.defaults.withCredentials=!0,a.when("/",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/courses",{templateUrl:"views/courses.html",controller:"CourseListCtrl"}).when("/course/:courseId/learning",{templateUrl:"views/coursequestion.html",controller:"CourseQuestionCtrl"}).when("/favorites",{templateUrl:"views/favorites.html",controller:"FavoritesCtrl"}).when("/favorites/learning",{templateUrl:"views/favoritesquestion.html",controller:"FavoritesQuestionCtrl"}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl"}).when("/registration",{templateUrl:"views/registration.html",controller:"RegistrationCtrl"}).when("/404",{templateUrl:"/404.html"}).when("/500",{templateUrl:"/500.html"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","$http","TokenService","AuthenticationService",function(a,b,c,d,e){d.get().success(function(a){c.defaults.headers.post["X-CSRF-Token"]=angular.fromJson(a)}).error(function(a,b){console.log("error data:"),console.log(a),console.log("error config:"),console.log(b)});var f=["/courses","/favorites"];a.$on("$routeChangeStart",function(){window._(f).contains(b.path())&&!e.isLoggedIn()&&(b.path("/login"),a.notifDanger="true",a.notification="You do not have permission. Have you tried logging in?")})}]);var kakaduServices=angular.module("kakaduSpaAppServices",["ngResource"]);kakaduServices.factory("MultipleQuestionService",function(){return{getAnswers:function(a,b){var c=[];return angular.forEach(b,function(b){c.push(a[b])}),c},getAnswerFields:function(a,b){var c=[];return angular.forEach(a,function(a,d){-1!==b.indexOf(a)&&c.push(d)}),c}}}),kakaduServices.factory("SessionService",function(){return{get:function(a){return sessionStorage.getItem(a)},set:function(a,b){return sessionStorage.setItem(a,b)},unset:function(a){return sessionStorage.removeItem(a)}}}),kakaduServices.factory("TokenService",["$http",function(a){return{get:function(){return a.get("http://localhost/kakadu/public/api/spa/token")}}}]),kakaduServices.factory("CoursesService",["$http",function(a){return{get:function(){return a.get("http://localhost/kakadu/public/api/spa/courses")},getPage:function(b,c,d,e){return a.get("http://localhost/kakadu/public/api/spa/courses?page="+b+"&per_page="+c+"&sort="+d+"&sort_dir="+e)},search:function(b){return a.get("http://localhost/kakadu/public/api/spa/courses/search?search="+b)}}}]),kakaduServices.factory("CourseQuestionService",["$http",function(a){return{getCourse:function(b){return a.get("http://localhost/kakadu/public/api/spa/course/"+b+"/learning")},getLearnFavorites:function(){return a.get("http://localhost/kakadu/public/api/spa/favorites/learning")},nextQuestion:function(b){return a.post("http://localhost/kakadu/public/api/spa/learning/next",b)}}}]),kakaduServices.factory("FavoritesService",["$http",function(a){return{getFavorites:function(){return a.get("http://localhost/kakadu/public/api/spa/favorites")},add:function(b){return a.post("http://localhost/kakadu/public/api/spa/favorites/add",b)},remove:function(b){return a.post("http://localhost/kakadu/public/api/spa/favorites/remove",b)}}}]),kakaduServices.factory("AuthenticationService",["$http","$sanitize","SessionService",function(a,b,c){var d=function(){c.set("authenticated",!0)},e=function(){c.unset("authenticated")};return{login:function(b){var c=a.post("http://localhost/kakadu/public/api/spa/auth/login",JSON.stringify(b));return c.success(d),c},logout:function(){var b=a.get("http://localhost/kakadu/public/api/spa/auth/logout");return b.success(e),b},isLoggedIn:function(){return c.get("authenticated")}}}]),kakaduServices.factory("ProfileService",["$http",function(a){return{editUser:function(b){return a.post("http://localhost/kakadu/public/api/spa/profile/edit",JSON.stringify(b))},changePwd:function(b){return a.post("http://localhost/kakadu/public/api/spa/profile/changepassword",JSON.stringify(b))},deleteProfile:function(){return a.post("http://localhost/kakadu/public/api/spa/profile/delete")}}}]),kakaduServices.factory("RegistrationService",["$http",function(a){return{register:function(b){return a.post("http://localhost/kakadu/public/api/spa/auth/register",JSON.stringify(b))}}}]),angular.module("kakaduSpaApp").directive("clozeQuestion",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"="},link:function(a,b){for(var c=a.ngModel.question,d=a.ngModel.answer,e=0;e<d.length;e++){var f=c.search(d[e]),g=f+d[e].length,h=c.substr(0,f),i=c.substr(g,c.length),j='<input type="text" id="answeredCloze['+e+']" style="background-color:#ababab; border:none"></input> <label id="'+d[e]+'" style="color:#3c763d"></label>';c=h+j+i}b.html(c),a.$watch("ngModel",function(){c=a.ngModel.question,d=a.ngModel.answer;for(var e=0;e<d.length;e++){var f=c.search(d[e]),g=f+d[e].length,h=c.substr(0,f),i=c.substr(g,c.length),j='<input type="text" id="answeredCloze['+e+']" style="background-color:#ababab; border:none"></input> <label id="'+d[e]+'" style="color:#3c763d"></label>';c=h+j+i}b.html(c)})}}}),angular.module("kakaduSpaApp").directive("header",function(){return{restrict:"E",templateUrl:"views/directives/header.html"}}),angular.module("kakaduSpaApp").directive("headerIndex",function(){return{restrict:"E",templateUrl:"views/directives/index-header.html"}}),angular.module("kakaduSpaApp").directive("footer",function(){return{restrict:"E",templateUrl:"views/directives/index-footer.html"}}),angular.module("kakaduSpaApp").directive("search",function(){return{restrict:"E",templateUrl:"views/directives/courses-search.html"}}),angular.module("kakaduSpaApp").directive("sorting",function(){return{restrict:"E",templateUrl:"views/directives/courses-sorting.html"}}),angular.module("kakaduSpaApp").directive("paginate",function(){return{restrict:"E",templateUrl:"views/directives/courses-pagination.html"}}),angular.module("kakaduSpaApp").directive("listCourses",function(){return{restrict:"E",templateUrl:"views/directives/courses-list.html"}}),angular.module("kakaduSpaApp").directive("searchSort",function(){return{restrict:"E",templateUrl:"views/directives/favorites-search-sort.html"}}),angular.module("kakaduSpaApp").directive("listFavorites",function(){return{restrict:"E",templateUrl:"views/directives/favorites-list.html"}}),angular.module("kakaduSpaApp").directive("progressbar",function(){return{restrict:"E",templateUrl:"views/directives/coursequestion-progressbar.html"}}),angular.module("kakaduSpaApp").directive("questiontypes",function(){return{restrict:"E",templateUrl:"views/directives/coursequestion-questiontypes.html"}}),angular.module("kakaduSpaApp").controller("LoginCtrl",["$rootScope","$scope","$location","$cookieStore","AuthenticationService","FavoritesService",function(a,b,c,d,e,f){function g(){b.notifInfo=void 0,b.notifDanger=void 0,b.notification=void 0}b.credentials={email:"",password:""},void 0!==b.registrationNotif&&(b.notifInfo="true",b.notifDanger="false",b.notification=a.registrationNotif,a.registrationNotif=void 0),b.login=function(){g(),e.login(b.credentials).success(function(a){d.put("displayname",a.displayname),d.put("email",a.email),d.put("language",a.language),d.put("databaseId",a.id),f.getFavorites().success(function(a){b.favorites=a,c.path(0===b.favorites.length?"/courses":"/favorites")}).error(function(a){angular.isString(a.message)?(b.notifInfo="false",b.notifDanger="true",b.notification=a.message):c.path("/500")})}).error(function(a){angular.isString(a.message)?(b.notifInfo="false",b.notifDanger="true",b.notification=a.message):c.path("/500")})}}]),angular.module("kakaduSpaApp").controller("CourseListCtrl",["$scope","$rootScope","$location","$http","$cookieStore","AuthenticationService","CoursesService","FavoritesService",function(a,b,c,d,e,f,g,h){function i(){a.notifSuccess="false",a.notifDanger="false",a.notification=void 0}a.orderProp="age",a.descript="false",a.activeCourseIndex=[],a.userId=e.get("databaseId"),a.notifSuccess="false",a.notifDanger="false",a.delay=0,a.minDuration=0,a.message="Please Wait...",a.backdrop=!0,a.promise=null,a.promise=g.get().success(function(b){a.courses=b,a.currentPage=1,a.pageSize=20,a.sort="name",a.sortDir="asc",a.setCurrentPage=function(b){i(),a.currentPage=b+1,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.nextPage=function(){i(),a.currentPage!==Math.ceil(a.courses.total/a.pageSize)&&(a.currentPage++,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")}))},a.previousPage=function(){i(),1!==a.currentPage&&(a.currentPage--,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")}))},a.getNumberAsArray=function(a){return new Array(a)},a.numberOfPages=function(){return Math.ceil(a.courses.total/a.pageSize)},a.changePageSize=function(b){i(),a.pageSize=b,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.sortBy=function(b){i(),a.sort=b,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.orderBy=function(b){i(),a.sortDir=b,g.getPage(a.currentPage,a.pageSize,a.sort,a.sortDir).success(function(b){a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})}}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")}),a.search=function(b){i(),g.search(b).success(function(b){a.courses=b,0===a.courses.total&&(a.notifSuccess="false",a.notifDanger="true",a.notification="The course does not exist.")}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.addFavorite=function(b){i(),a.favoritemodel={id:b,type:"course"},h.add(a.favoritemodel).success(function(b){a.notifSuccess="true",a.notifDanger="false",a.notification="Course has been added to Your courses",a.courses=b}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.showDescription=function(b){i(),a.activeCourseIndex.push(b)},a.hideDescription=function(b){i(),-1!==a.activeCourseIndex.indexOf(b)&&a.activeCourseIndex.splice(a.activeCourseIndex.indexOf(b),1)},a.isShowing=function(b){return-1!==a.activeCourseIndex.indexOf(b)?!0:void 0},a.logOut=function(){i(),f.logout().success(function(){c.path("/"),e.remove("displayname"),e.remove("email"),e.remove("language"),e.remove("databaseId")}).error(function(a){angular.isString(a.message)?(b.notifDanger="true",b.notification=a.message):c.path("/500")})}}]),angular.module("kakaduSpaApp").controller("CourseQuestionCtrl",["$rootScope","$scope","$routeParams","$http","$location","$cookieStore","AuthenticationService","CourseQuestionService","MultipleQuestionService",function(a,b,c,d,e,f,g,h,i){function j(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}b.delay=0,b.minDuration=0,b.message="Please Wait...",b.backdrop=!0,b.promise=null,b.showStat="false",b.promise=h.getCourse(c.courseId).success(function(d){b.question=d,b.checkAnswer="false",b.message="",b.mSuccess="",b.mFailure="",b.notifSuccess="false",b.notifFailure="false",b.numCorrectPercentage=b.question.numCorrect/b.question.numAnswered*100,b.numIncorrectPercentage=b.question.numIncorrect/b.question.numAnswered*100,"simple"===b.question.type?(b.showSimpleAnswer="false",b.simpleAnswered="false"):"multiple"===b.question.type?(b.chosenChoisesMultiple=[],b.choicesFieldNum=[],b.question.choices&&(b.rightAnswersMultiple=i.getAnswers(b.question.choices,b.question.answer)),b.showCheckMultiple="true",b.showNextMultiple="false",b.showSolution="false",b.chooseButtonMultiple=[],b.shuffledChoices=j(b.question.choices),b.correctAnswerField=i.getAnswerFields(b.shuffledChoices,b.rightAnswersMultiple)):"dragdrop"===b.question.type?(b.choiceDrop="",b.shuffledChoices=j(b.question.choices)):"cloze"===b.question.type&&(b.answeredCloze=[],b.numRightGaps=0,b.showCheckCloze="true",b.showNextCloze="false",b.disableCloze=0),b.showSimple=function(){b.showSimpleAnswer="true",b.simpleAnswered="true"},b.simpleAnswerCorrect=function(){b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct.",b.simpleAnswered="false"},b.simpleAnswerWrong=function(){b.checkAnswer="false",b.notifFailure="true",b.mFailure="You answered wrong.",b.simpleAnswered="false"},b.chooseChoiceMultiple=function(a,c){if(-1===b.choicesFieldNum.indexOf(c))b.chooseButtonMultiple[c]={"border-style":"solid","border-width":"thick"},b.choicesFieldNum.push(c),-1===b.chosenChoisesMultiple.indexOf(a)&&b.chosenChoisesMultiple.push(a);else{b.chooseButtonMultiple[c]={"background-color":"white"};for(var d=b.choicesFieldNum.length-1;d>=0;d--)b.choicesFieldNum[d]===c&&b.choicesFieldNum.splice(d,1);for(var e=b.chosenChoisesMultiple.length-1;e>=0;e--)b.chosenChoisesMultiple[e]===a&&b.chosenChoisesMultiple.splice(e,1)}},b.checkMultiple=function(){var a=0;b.showCheckMultiple="false",b.showNextMultiple="true",0===b.chosenChoisesMultiple.length&&(a++,angular.forEach(b.correctAnswerField,function(a){b.chooseButtonMultiple[a]={"background-color":"#dff0d8"}})),angular.forEach(b.chosenChoisesMultiple,function(c,d){-1===b.rightAnswersMultiple.indexOf(c)?(a++,b.chooseButtonMultiple[b.choicesFieldNum[d]]={"background-color":"#f2dede","border-style":"solid","border-width":"thick"}):b.chooseButtonMultiple[b.choicesFieldNum[d]]={"background-color":"#dff0d8","border-style":"solid","border-width":"thick"}}),0===a?(b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct."):0===b.chosenChoisesMultiple.length?(b.notifFailure="true",b.mFailure="You answered wrong."):(b.showSolution="true",b.notifFailure="true",b.mFailure="You answered wrong.")},b.showCorrectAnswers=function(){b.showSolution="false",angular.forEach(b.correctAnswerField,function(a){b.chooseButtonMultiple[a]={"background-color":"#dff0d8"}})},b.dropCallback=function(a,c,d){b.mSuccess="You answered correct.",b.question.answer===d?(b.checkAnswer="true",b.notifSuccess="true",b.notifFailure="false",b.mSuccess="You answered correct."):(b.notifSuccess="false",b.notifFailure="true",b.mFailure="You answered wrong.")},b.showDraggable=function(a){return-1!==b.question.choices.indexOf(a)?!0:!1},b.checkCloze=function(){b.showCheckCloze="false",b.showNextCloze="true",angular.forEach(b.question.answer,function(a,c){angular.lowercase(angular.element(document.getElementById("answeredCloze["+c+"]")).val())===angular.lowercase(a)?(b.numRightGaps++,angular.element(document.getElementById("answeredCloze["+c+"]").style.backgroundColor="#dff0d8"),angular.element(document.getElementById("answeredCloze["+c+"]").style.borderColor="#d6e9c6"),angular.element(document.getElementById("answeredCloze["+c+"]").style.color="#3c763d")):(angular.element(document.getElementById("answeredCloze["+c+"]").style.backgroundColor="#f2dede"),angular.element(document.getElementById("answeredCloze["+c+"]").style.borderColor="#ebccd1"),angular.element(document.getElementById("answeredCloze["+c+"]").style.color="#a94442"),angular.element(document.getElementById(a).innerHTML=a)),angular.element(document.getElementById("answeredCloze["+c+"]").setAttribute("disabled",!0))}),b.numRightGaps===b.question.answer.length?(b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct."):(b.notifFailure="true",b.mFailure="You answered wrong."),b.disableCloze++},b.nextQuestion=function(){b.questionmodel={question:b.question.id,course:b.question.course,catalog:b.question.catalog,section:"course",answer:b.checkAnswer},h.nextQuestion(b.questionmodel).success(function(a){b.question=a,b.checkAnswer="false",b.message="",b.mSuccess="",b.mFailure="",b.notifSuccess="false",b.notifFailure="false",b.numCorrectPercentage=b.question.numCorrect/b.question.numAnswered*100,b.numIncorrectPercentage=b.question.numIncorrect/b.question.numAnswered*100,"simple"===b.question.type?(b.showSimpleAnswer="false",b.simpleAnswered="false"):"multiple"===b.question.type?(b.chosenChoisesMultiple=[],b.choicesFieldNum=[],b.question.choices&&(b.rightAnswersMultiple=i.getAnswers(b.question.choices,b.question.answer)),b.showCheckMultiple="true",b.showNextMultiple="false",b.showSolution="false",b.chooseButtonMultiple=[],b.shuffledChoices=j(b.question.choices),b.correctAnswerField=i.getAnswerFields(b.shuffledChoices,b.rightAnswersMultiple)):"dragdrop"===b.question.type?(b.choiceDrop="",b.shuffledChoices=j(b.question.choices)):"cloze"===b.question.type&&(b.answeredCloze=[],b.numRightGaps=0,b.showCheckCloze="true",b.showNextCloze="false",b.disableCloze=0)}).error(function(b){e.path("/"),a.notifDanger="true",a.notification=b.message})},b.showStatistic=function(){b.showStat="false"===b.showStat?"true":"false"},b.logOut=function(){g.logout().success(function(){f.remove("displayname"),f.remove("email"),f.remove("language"),f.remove("databaseId")}).error(function(b){e.path("/course/"+c.courseId+"/learning"),a.notifDanger="true",a.notification=b.message})}}).error(function(b){e.path("/"),a.notifDanger="true",a.notification=b.message+". Have you logged in?"})}]),angular.module("kakaduSpaApp").controller("FavoritesCtrl",["$scope","$rootScope","$location","$http","$cookieStore","AuthenticationService","FavoritesService",function(a,b,c,d,e,f,g){function h(){a.notifInfo="false",a.notifDanger="false",a.notification=void 0}a.activeFavoriteIndex=[],a.notifInfo="false",a.notifDanger="false",a.delay=0,a.minDuration=0,a.message="Please Wait...",a.backdrop=!0,a.promise=null,a.promise=g.getFavorites().success(function(b){a.favorites=b,0===a.favorites.length&&(a.notifInfo="true",a.notifDanger="false",a.notification="Your list is currently empty")}).error(function(b){angular.isString(b.message)?(a.notifInfo="false",a.notifDanger="true",a.notification=b.message):c.path("/500")}),a.orderProp="age",a.removeFavorite=function(b){h(),a.favoritemodel={id:b,type:"course"},g.remove(a.favoritemodel).success(function(b){a.favorites=b,0===a.favorites.length&&(a.notifInfo="true",a.notifDanger="false",a.notification="Your list is currently empty")}).error(function(b){angular.isString(b.message)?(a.notifInfo="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.showDescription=function(b){h(),a.activeFavoriteIndex.push(b)},a.hideDescription=function(b){h(),-1!==a.activeFavoriteIndex.indexOf(b)&&a.activeFavoriteIndex.splice(a.activeFavoriteIndex.indexOf(b),1)},a.isShowing=function(b){return-1!==a.activeFavoriteIndex.indexOf(b)?!0:void 0},a.logOut=function(){h(),f.logout().success(function(){c.path("/"),e.remove("displayname"),e.remove("email"),e.remove("language"),e.remove("databaseId")}).error(function(d){angular.isString(d.message)?(a.notifInfo="false",b.notifDanger="true",b.notification=d.message):c.path("/500")})}}]),angular.module("kakaduSpaApp").controller("FavoritesQuestionCtrl",["$rootScope","$scope","$routeParams","$http","$location","$cookieStore","AuthenticationService","CourseQuestionService","MultipleQuestionService",function(a,b,c,d,e,f,g,h,i){function j(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}b.delay=0,b.minDuration=0,b.message="Please Wait...",b.backdrop=!0,b.promise=null,b.promise=h.getLearnFavorites().success(function(d){b.question=d,b.checkAnswer="false",b.message="",b.mSuccess="",b.mFailure="",b.notifSuccess="false",b.notifFailure="false","simple"===b.question.type?(b.showSimpleAnswer="false",b.simpleAnswered="false"):"multiple"===b.question.type?(b.chosenChoisesMultiple=[],b.choicesFieldNum=[],b.question.choices&&(b.rightAnswersMultiple=i.getAnswers(b.question.choices,b.question.answer)),b.showCheckMultiple="true",b.showNextMultiple="false",b.showSolution="false",b.chooseButtonMultiple=[],b.shuffledChoices=j(b.question.choices),b.correctAnswerField=i.getAnswerFields(b.shuffledChoices,b.rightAnswersMultiple)):"dragdrop"===b.question.type?(b.choiceDrop="",b.shuffledChoices=j(b.question.choices)):"cloze"===b.question.type&&(b.answeredCloze=[],b.numRightGaps=0,b.showCheckCloze="true",b.showNextCloze="false",b.disableCloze=0),b.showSimple=function(){b.showSimpleAnswer="true",b.simpleAnswered="true"},b.simpleAnswerCorrect=function(){b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct.",b.simpleAnswered="false"},b.simpleAnswerWrong=function(){b.checkAnswer="false",b.notifFailure="true",b.mFailure="You answered wrong.",b.simpleAnswered="false"},b.chooseChoiceMultiple=function(a,c){if(-1===b.choicesFieldNum.indexOf(c))b.chooseButtonMultiple[c]={"border-style":"solid","border-width":"thick"},b.choicesFieldNum.push(c),-1===b.chosenChoisesMultiple.indexOf(a)&&b.chosenChoisesMultiple.push(a);else{b.chooseButtonMultiple[c]={"background-color":"white"};for(var d=b.choicesFieldNum.length-1;d>=0;d--)b.choicesFieldNum[d]===c&&b.choicesFieldNum.splice(d,1);for(var e=b.chosenChoisesMultiple.length-1;e>=0;e--)b.chosenChoisesMultiple[e]===a&&b.chosenChoisesMultiple.splice(e,1)}},b.checkMultiple=function(){var a=0;b.showCheckMultiple="false",b.showNextMultiple="true",0===b.chosenChoisesMultiple.length&&(a++,angular.forEach(b.correctAnswerField,function(a){b.chooseButtonMultiple[a]={"background-color":"#dff0d8"}})),angular.forEach(b.chosenChoisesMultiple,function(c,d){-1===b.rightAnswersMultiple.indexOf(c)?(a++,b.chooseButtonMultiple[b.choicesFieldNum[d]]={"background-color":"#f2dede","border-style":"solid","border-width":"thick"}):b.chooseButtonMultiple[b.choicesFieldNum[d]]={"background-color":"#dff0d8","border-style":"solid","border-width":"thick"}}),0===a?(b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct."):0===b.chosenChoisesMultiple.length?(b.notifFailure="true",b.mFailure="You answered wrong."):(b.showSolution="true",b.notifFailure="true",b.mFailure="You answered wrong.")},b.showCorrectAnswers=function(){b.showSolution="false",angular.forEach(b.correctAnswerField,function(a){b.chooseButtonMultiple[a]={"background-color":"#dff0d8"}})},b.dropCallback=function(a,c,d){b.mSuccess="You answered correct.",b.question.answer===d?(b.checkAnswer="true",b.notifSuccess="true",b.notifFailure="false",b.mSuccess="You answered correct."):(b.notifSuccess="false",b.notifFailure="true",b.mFailure="You answered wrong.")},b.showDraggable=function(a){return-1!==b.question.choices.indexOf(a)?!0:!1},b.checkCloze=function(){b.showCheckCloze="false",b.showNextCloze="true",angular.forEach(b.question.answer,function(a,c){angular.lowercase(angular.element(document.getElementById("answeredCloze["+c+"]")).val())===angular.lowercase(a)?(b.numRightGaps++,angular.element(document.getElementById("answeredCloze["+c+"]").style.backgroundColor="#dff0d8"),angular.element(document.getElementById("answeredCloze["+c+"]").style.borderColor="#d6e9c6"),angular.element(document.getElementById("answeredCloze["+c+"]").style.color="#3c763d")):(angular.element(document.getElementById("answeredCloze["+c+"]").style.backgroundColor="#f2dede"),angular.element(document.getElementById("answeredCloze["+c+"]").style.borderColor="#ebccd1"),angular.element(document.getElementById("answeredCloze["+c+"]").style.color="#a94442"),angular.element(document.getElementById(a).innerHTML=a)),angular.element(document.getElementById("answeredCloze["+c+"]").setAttribute("disabled",!0))}),b.numRightGaps===b.question.answer.length?(b.checkAnswer="true",b.notifSuccess="true",b.mSuccess="You answered correct."):(b.notifFailure="true",b.mFailure="You answered wrong."),b.disableCloze++},b.nextQuestion=function(){b.questionmodel={question:b.question.id,course:b.question.course,catalog:b.question.catalog,section:"favorites",answer:b.checkAnswer},h.nextQuestion(b.questionmodel).success(function(a){b.question=a,b.checkAnswer="false",b.message="",b.mSuccess="",b.mFailure="",b.notifSuccess="false",b.notifFailure="false","simple"===b.question.type?(b.showSimpleAnswer="false",b.simpleAnswered="false"):"multiple"===b.question.type?(b.chosenChoisesMultiple=[],b.choicesFieldNum=[],b.question.choices&&(b.rightAnswersMultiple=i.getAnswers(b.question.choices,b.question.answer)),b.showCheckMultiple="true",b.showNextMultiple="false",b.showSolution="false",b.chooseButtonMultiple=[],b.shuffledChoices=j(b.question.choices),b.correctAnswerField=i.getAnswerFields(b.shuffledChoices,b.rightAnswersMultiple)):"dragdrop"===b.question.type?(b.choiceDrop="",b.shuffledChoices=j(b.question.choices)):"cloze"===b.question.type&&(b.answeredCloze=[],b.numRightGaps=0,b.showCheckCloze="true",b.showNextCloze="false",b.disableCloze=0)}).error(function(b){e.path("/"),a.notifDanger="true",a.notification=b.message})},b.logOut=function(){g.logout().success(function(){f.remove("displayname"),f.remove("email"),f.remove("language"),f.remove("databaseId")}).error(function(b){e.path("/course/"+c.courseId+"/learning"),a.notifDanger="true",a.notification=b.message})}}).error(function(b){e.path("/"),a.notifDanger="true",a.notification=b.message+". Have you logged in?"})}]),angular.module("kakaduSpaApp").controller("ProfileCtrl",["$scope","$rootScope","$location","$cookieStore","ProfileService","SessionService","AuthenticationService",function(a,b,c,d,e,f,g){function h(){a.notifSuccess=void 0,a.notifDanger=void 0,a.notification=void 0}a.delay=0,a.minDuration=0,a.message="Please Wait...",a.backdrop=!0,a.promise=null,a.languages=[{id:"en",acronym:"en"}],a.userCredentials={displayname:d.get("displayname"),email:d.get("email"),language:d.get("language")},a.editUser=function(){h(),a.promise=e.editUser(a.userCredentials).success(function(){d.put("displayname",a.userCredentials.displayname),d.put("email",a.userCredentials.email),d.put("language",a.userCredentials.language),a.notifSuccess="true",a.notifDanger="false",a.notification="Your user information has been changed."}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.changePwd=function(){h(),a.promise=e.changePwd(a.passwordCredentials).success(function(){a.notifSuccess="true",a.notifDanger="false",a.notification="Your password has been changed."}).error(function(b){angular.isString(b.message)?(a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.deleteProfile=function(){h(),a.promise=e.deleteProfile().success(function(){b.registrationNotif="Your profile has been deleted",f.unset("authenticated"),d.remove("databaseId"),c.path("/")}).error(function(b){angular.isString(b.message)?(a.notifSuccess="false",a.notifDanger="true",a.notification=b.message):c.path("/500")})},a.logOut=function(){h(),g.logout().success(function(){c.path("/"),d.remove("displayname"),d.remove("email"),d.remove("language"),d.remove("databaseId")}).error(function(a){angular.isString(a.message)?(b.notifDanger="true",b.notification=a.message):c.path("/500")})}}]),angular.module("kakaduSpaApp").controller("RegistrationCtrl",["$scope","$rootScope","$location","RegistrationService",function(a,b,c,d){a.register=function(){a.notifDanger=void 0,d.register(a.credentials).success(function(){b.registrationNotif="You are registered.",c.path("/")}).error(function(b){angular.isString(b.message)?(a.notifDanger="true",a.notification=b.message):c.path("/500")})}}]),!function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery);