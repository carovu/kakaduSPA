"use strict";angular.module("kakaduSpaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","kakaduSpaAppServices"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/courses",{templateUrl:"views/courses.html",controller:"CourseListCtrl"}).when("/course/:courseId/learning",{templateUrl:"views/coursequestion.html",controller:"CourseQuestionCtrl"}).otherwise({redirectTo:"/"})}]);var kakaduServices=angular.module("kakaduSpaAppServices",["ngResource"]);kakaduServices.factory("Test",["$resource",function(a){return a("/kakadu/public/api/v1/learning/next")}]),kakaduServices.factory("FlashService",["$rootScope",function(a){return{show:function(b){a.flash=b},clear:function(){a.flash=""}}}]),kakaduServices.factory("CoursesService",["$http",function(a){return{get:function(){return a.get("http://localhost/kakadu/public/api/spa/courses")}}}]),kakaduServices.factory("TokenService",["$http",function(a){return{get:function(){return a.get("http://localhost/kakadu/public/api/spa/token")}}}]),kakaduServices.factory("SessionService",function(){return{get:function(a){return sessionStorage.getItem(a)},set:function(a,b){return sessionStorage.setItem(a,b)},unset:function(a){return sessionStorage.removeItem(a)}}}),kakaduServices.factory("AuthenticationService",["$http","$sanitize","SessionService","FlashService",function(a,b,c,d){var e=function(){c.set("authenticated",!0)},f=function(){c.unset("authenticated")},g=function(a){d.show(a.flash)},h=function(a){return{email:b(a.email),password:b(a.password)}};return{login:function(b){console.log(JSON.stringify(h(b)));var c=a.post("http://localhost/kakadu/public/api/spa/auth/login",JSON.stringify(b));return c.success(e),c.success(d.clear),c.error(g),c},logout:function(){var b=a.get("/auth/logout");return b.success(f),b},isLoggedIn:function(){return c.get("authenticated")}}}]),angular.module("kakaduSpaApp").controller("LoginCtrl",["$scope","$location","AuthenticationService",function(a,b,c){a.credentials={email:"",password:""},a.login=function(){c.login(a.credentials).success(function(){console.log("success"),b.path("/courses")})}}]),angular.module("kakaduSpaApp").controller("CourseListCtrl",["$scope","$location","AuthenticationService","CoursesService",function(a,b,c,d){d.get().success(function(b){a.courses=b}),a.orderProp="age",a.logout=function(){c.logout().success(function(){b.path("/login")})}}]),angular.module("kakaduSpaApp").controller("CourseQuestionCtrl",["$scope","$routeParams","$http",function(a,b,c,d,e){c.get("http://localhost/kakadu/public/api/spa/course/"+b.courseId+"/learning").success(function(b){a.question=b,a.logout=function(){e.logout().success(function(){d.path("/login")})}})}]);